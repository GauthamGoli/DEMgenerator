<head>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<link href="http://159.122.251.165:8889/static/dashboard.css" rel="stylesheet">
    <link href="http://159.122.251.165:8889/static/custom.css" rel="stylesheet">
	<style>
	    
	    #map {width: 100%; height: 88%}
	</style>
</head>
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script>
var map;
var lat=[];
var long=[];
function initialize() {
    map = new google.maps.Map(document.getElementById('map'), {
        zoom: 5,
        center: new google.maps.LatLng(28.110748760633534, 80.771484375),
        mapTypeId: google.maps.MapTypeId.SATELLITE,
    });
    google.maps.event.addListener(map, 'click', function(event) {
    placeMarker(event.latLng);
    });


}
function placeMarker(location) {
      var marker = new google.maps.Marker({
        position: location,
        map: map,
        draggable: true
      });
      var infowindow = new google.maps.InfoWindow({
        content: 'Latitude: ' + location.lat() +
        '<br>Longitude: ' + location.lng()
      });
      lat.push(location.lat())
      long.push(location.lng())
      infowindow.open(map,marker);
    }
function post(path, params, method) {
    method = method || "post"; // Set method to post by default if not specified.

    // The rest of this code assumes you are not using a library.
    // It can be made less wordy if you use one.
    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);

    for(var key in params) {
        if(params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            //hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
         }
    }

    //document.body.appendChild(form);
    //form.submit();

    var XHR = new XMLHttpRequest();

    // We bind the FormData object and the form element
    var FD  = new FormData();
    FD.append("lat",params["lat"]);
    FD.append("long",params["long"]);
    FD.append("interval",params["interval"]);

    // We define what will happen if the data are successfully sent
    XHR.addEventListener("load", function(event) {
      console.log(event.target.responseText);
      $("#tiff-button").attr("onclick","window.open('http://159.122.251.165:8889/static/testf_"+event.target.responseText+".tiff')");
      $("#csv-button").attr("onclick","window.open('http://159.122.251.165:8889/static/altitude_"+event.target.responseText+".csv')");
      $(".btn").toggleClass('hidden');
    });

    // We define what will happen in case of error
    XHR.addEventListener("error", function(event) {
      console.log('Oups! Something goes wrong.');
    });

    // We setup our request
    XHR.open("POST", path);

    // The data sent are the one the user provide in the form
    XHR.send(FD);

    
}

</script>
<body onload='initialize()'>
	<nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="col-md-6 col-md-offset-5">
        <div class="navbar-header text-center">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">DEM Generation</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          
          
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <!--<li class="active"><a href="#">Download Tiff <span class="sr-only">(current)</span></a></li> -->
            <li><button type="button" id="tiff-button" class="btn btn-default center-element hidden" onclick="">Download Tiff</button></li><br>
            <li><button type="button" id="csv-button" class="btn btn-default center-element hidden" onclick="">Download csv</button></li>
            
          </ul>
          
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <div id=map></div>
<div> Resolution(meters) : <input type="text" name="resolution" id="resolution"> </div>
<div> <input type="button" value="Submit" onclick="post('http://159.122.251.165:8889/gmap/',{lat: lat,long: long,interval: document.getElementById('resolution').value})"> </div>
        </div>
      </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
</body>